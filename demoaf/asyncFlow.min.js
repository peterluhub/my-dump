(function(k){function v(b,c,a){var d;b[c](function(b,f){d||(d=1,b?a[0]=0:(a[1][c]=f,a[0]-=1),a[0]||a[3]||(a[3]=1,a[2](b,a[1])))})}function s(b,c,a){var d;b[c](function(e,f){d||((d=1,a[3]-=1,e)?a[5]||(a[5]=1,a[2](e,a[1])):(a[1][c]=f,a[0]+=1,a[0]<a[4]?(a[3]+=1,s(b,a[0],a)):a[3]||a[5]||(a[5]=1,a[2](e,a[1]))))})}k.waterfall=function(b,c){function a(e,f){d+=1;var h=b[d];e?c(e,f):h?h(f,a):c(e,f)}var d=0;b[0](null,a)};k.safeWaterfall=function(b,c){var a=0,d=function(){var e;return function(f,h){if(!e){e=
1;a+=1;var g=b[a];f?c(f,h):g?g(h,d()):c(f,h)}}};b[0](null,d(0))};k.series=function(b,c){k.parallelLimit(b,1,c)};k.filterSeries=function(b,c,a){function d(g){var t;c(b[g],function(c,k){t||(t=1,c?a(c,f):(k&&(f[h]=b[g],h+=1),g+=1,g<e?d(g):a(c,f)))})}var e=b.length,f=[],h=0;d(0)};k.mapSeries=function(b,c,a){function d(h){var g;c(b[h],function(b,c){g||(g=1,b?a(b,f):(f[h]=c,h+=1,h<e?d(h):a(b,f)))})}var e=b.length,f=[];d(0)};k.filterParallel=function(b,c,a){function d(d){var e;c(b[d],function(c,k){if(!e&&
(e=1,c?h=0:(k&&(f[d]=b[d]),h-=1),!h&&!g))if(g=1,c)a(c,f);else{for(var u=[],r=f.length,n=0,m=0;m<r;m+=1)f[m]&&(u[n]=f[m],n+=1);a(c,u)}})}for(var e=b.length,f=Array(e),h=e,g=0;e;)e-=1,d(e)};k.filter=k.filterParallel;k.mapParallel=function(b,c,a){function d(d){var e;c(b[d],function(b,c){e||((e=1,b)?g||(g=1,a(b,f)):(f[d]=c,h-=1,h||g||(g=1,a(b,f))))})}for(var e=b.length,f=Array(e),h=e,g=0;e;)e-=1,d(e)};k.map=k.mapParallel;k.filterLimit=function(b,c,a,d){function e(a){var p;c(b[a],function(c,r){if(!p)if(p=
1,c)k||(k=1,d(c,h));else if(g-=1,r&&(h[a]=b[a]),l<f)k||(g+=1,e(l++));else if(!g&&!k){k=1;for(var n=[],m=0,q=0;q<f;q+=1)h[q]&&(n[m]=h[q],m+=1);d(c,n)}})}var f=b.length;if(!a||a>f)throw"limit not specified or too big";for(var h=[],g=0,k=0,l=0;l<a;l+=1)g+=1,e(l)};k.mapLimit=function(b,c,a,d){function e(a){var p;c(b[a],function(b,c){p||((p=1,b)?k||(k=1,d(b,h)):(g-=1,h[a]=c,l<f?k||(g+=1,e(l++)):g||k||(k=1,d(b,h))))})}var f=b.length;if(!a||a>f)throw"limit not specified or too big";for(var h=[],g=0,k=0,
l=0;l<a;l+=1)g+=1,e(l)};k.parallel=function(b,c){for(var a=b.length,d=[a,[],c,0];a;)a-=1,v(b,a,d)};k.parallelLimit=function(b,c,a){var d=b.length;if(!c||c>d)throw"limit not specified or too big";a=[c-1,[],a,0,d,0];for(d=0;d<c;d+=1)a[3]+=1,s(b,d,a)};k.apply=function(b){var c=[].slice.call(arguments,1);return function(a){c.push(a);return b.apply(null,c)}}})(module&&exports?exports:this.asyncFlow=this.asyncFlow||{});
